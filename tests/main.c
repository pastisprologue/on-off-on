////////////////////////////////////////////////////////////////////////////////
//!
//! @file             main.c
//!
//! @author           Michael Chiasson
//!
//! @date             2022/08/11
//!
//! @brief            
//!
//! @details          
//!
//! @copyright        2022. Extreme Waves, Inc. (http://www.extreme-waves.com)
//!                   All Rights Reserved                    
//!
////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////
//  Includes
////////////////////////////////////////////////////////////////////////////////

#include <assert.h>

#include "on_off_on.h"


////////////////////////////////////////////////////////////////////////////////
//  Private Macros
////////////////////////////////////////////////////////////////////////////////



////////////////////////////////////////////////////////////////////////////////
//  Private Types
////////////////////////////////////////////////////////////////////////////////



////////////////////////////////////////////////////////////////////////////////
//  Private Function Prototypes
////////////////////////////////////////////////////////////////////////////////



////////////////////////////////////////////////////////////////////////////////
//  Public Data
////////////////////////////////////////////////////////////////////////////////



////////////////////////////////////////////////////////////////////////////////
//  Private Data
////////////////////////////////////////////////////////////////////////////////

static on_off_on_t controller;
static const on_off_on_config_t controller_config = { .hysteresis = 10 };


////////////////////////////////////////////////////////////////////////////////
//  Public Function Implementations
////////////////////////////////////////////////////////////////////////////////

int main()
{
    init_on_off_on(&controller, &controller_config);
    assert(controller.state == ON_OFF_ON_STATE_STEADY_STATE);
    assert(controller.hysteresis == controller_config.hysteresis);

    set_on_off_on_setpoint(&controller, 50);
    assert(controller.setpoint == 50);

    on_off_on_state_e state = compute_on_off_on(&controller, 30);
    assert(state == ON_OFF_ON_STATE_FORWARD);

    state = compute_on_off_on(&controller, 50);
    assert(state == ON_OFF_ON_STATE_FORWARD);

    state = compute_on_off_on(&controller, 51);
    assert(state == ON_OFF_ON_STATE_STEADY_STATE);

    state = compute_on_off_on(&controller, 60);
    assert(state == ON_OFF_ON_STATE_STEADY_STATE);
    
    state = compute_on_off_on(&controller, 61);
    assert(state == ON_OFF_ON_STATE_BACKWARD);
    
    state = compute_on_off_on(&controller, 50);
    assert(state == ON_OFF_ON_STATE_BACKWARD);
    
    state = compute_on_off_on(&controller, 49);
    assert(state == ON_OFF_ON_STATE_STEADY_STATE);

    set_on_off_on_hysteresis(&controller, 5);
    assert(controller.hysteresis == 5);

    state = compute_on_off_on(&controller, 51);
    assert(state == ON_OFF_ON_STATE_STEADY_STATE);

    state = compute_on_off_on(&controller, 55);
    assert(state == ON_OFF_ON_STATE_STEADY_STATE);
    
    state = compute_on_off_on(&controller, 56);
    assert(state == ON_OFF_ON_STATE_BACKWARD);
    
    return 0;
}


////////////////////////////////////////////////////////////////////////////////
//  Private Function Implementations
////////////////////////////////////////////////////////////////////////////////




